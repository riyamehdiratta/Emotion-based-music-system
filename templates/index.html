<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Emotion-Based Music Recommendation System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>üéµ Emotion-Based Music Recommendation</h1>
            <p class="subtitle">Detect your emotion and discover music that matches your mood</p>
            <p class="disclaimer">‚ö†Ô∏è This system recommends music, not medical advice.</p>
            <p class="spotify-note" style="font-size: 0.85em; opacity: 0.8; margin-top: 5px;">
                üéµ Powered by <a href="https://www.spotify.com" target="_blank" style="color: #1DB954;">Spotify</a> - Real songs, multiple languages
            </p>
        </header>

        <main>
            <!-- Emotion Detection Section -->
            <section class="detection-section">
                <h2>1. Detect Your Emotion</h2>
                
                <div class="input-methods">
                    <div class="method-tabs">
                        <button class="tab-btn active" onclick="switchTab('upload')">üìÅ Upload Image</button>
                        <button class="tab-btn" onclick="switchTab('webcam')">üì∑ Webcam</button>
                    </div>

                    <!-- Image Upload Tab -->
                    <div id="upload-tab" class="tab-content active">
                        <div class="upload-area" id="upload-area">
                            <input type="file" id="image-input" accept="image/*" style="display: none;">
                            <div class="upload-placeholder">
                                <p>üì∏ Click or drag an image here</p>
                                <p class="upload-hint">Supports: JPG, PNG, GIF (Max 5MB)</p>
                            </div>
                        </div>
                        <div id="image-preview" class="image-preview" style="display: none;">
                            <img id="preview-img" src="" alt="Preview">
                            <button class="remove-btn" onclick="removeImage()">‚úï</button>
                        </div>
                    </div>

                    <!-- Webcam Tab -->
                    <div id="webcam-tab" class="tab-content">
                        <div class="webcam-container">
                            <video id="webcam-video" autoplay playsinline style="display: none;"></video>
                            <canvas id="webcam-canvas" style="display: none;"></canvas>
                            <div id="webcam-placeholder" class="webcam-placeholder">
                                <p>üì∑ Click to start webcam</p>
                            </div>
                            <div class="webcam-controls">
                                <button id="start-webcam-btn" class="btn btn-primary" onclick="startWebcam()">Start Webcam</button>
                                <button id="capture-btn" class="btn btn-success" onclick="captureWebcam()" style="display: none;">Capture Photo</button>
                                <button id="stop-webcam-btn" class="btn btn-danger" onclick="stopWebcam()" style="display: none;">Stop Webcam</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Language will be selected AFTER emotion detection to enforce user flow -->

                <button id="detect-btn" class="btn btn-primary btn-large" onclick="detectEmotion()" disabled>
                    üîç Detect Emotion
                </button>
            </section>

            <!-- Emotion Result Section -->
            <section id="emotion-result" class="result-section" style="display: none;">
                <h2>2. Detected Emotion</h2>
                <div class="emotion-display">
                    <div class="emotion-icon" id="emotion-icon">üòä</div>
                    <div class="emotion-info">
                            <h3 id="emotion-name">Happy</h3>
                            <p class="confidence">Confidence: <span id="confidence-score">85%</span></p>
                            <p class="selected-language">Selected language: <span id="selected-language">None</span></p>
                        </div>
                </div>
                <div class="all-emotions" id="all-emotions"></div>
            </section>

            <!-- Language Filter Section -->
            <section id="language-section" class="filter-section" style="display: none;">
                <h2>3. Choose Language (Optional)</h2>
                <select id="language-filter" class="language-select" onchange="filterByLanguage()">
                    <option value="English">English</option>
                    <option value="Hindi">Hindi</option>
                    <option value="Punjabi">Punjabi</option>
                    <option value="Spanish">Spanish</option>
                </select>
            </section>

            <!-- Recommendations Section -->
            <section id="recommendations-section" class="recommendations-section" style="display: none;">
                <h2>4. Recommended Songs</h2>
                <div id="recommendations-list" class="recommendations-list"></div>
            </section>
        </main>

        <footer>
            <p>Built with ‚ù§Ô∏è for music lovers | Open Source</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>

